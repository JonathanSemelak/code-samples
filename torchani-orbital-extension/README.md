# TorchANI Orbital Extension

This module extends the TorchANI framework to support custom descriptors derived from electronic densities, enabling neural network models to predict exchange-correlation (Exc) energies from atomic orbital coefficients.

## Overview

The core components in this folder modify TorchANIâ€™s featurization and model pipeline to process *orbital atomic environment vectors (orbital AEVs)*. These descriptors are computed from the fitting density (auxiliary basis representation of the electron density) and encode local electronic information through s, p, and d orbital coefficients.

Key additions:
- `orbital_aev.py`: Custom feature generator for orbital AEVs
- `container.py`: A model wrapper that replaces the standard AEV pipeline with orbital-based descriptors
- `featurizer.py`: Interface for computing and preprocessing orbital descriptors

## Why predict Exc with a neural network?

In Kohn-Sham DFT, the exchange-correlation energy (Exc) is the most computationally demanding term and a major source of approximation error. By training a neural network on descriptors derived directly from the electron density, this module aims to bypass conventional Exc functionals and predict Exc accurately and efficiently.

## Dataset

This model was trained and tested on a custom dataset of **20 million electron densities**, that I generated by running quantum mechanical simulations on a 10% downsampling of the TorchANI-2x dataset.  
The dataset includes both the converged and intermediate (non-self-consistent) fitting densities from SCF calculations.  
**Note:** The dataset has not been made publicly available yet.

## What's next?

The long-term goal is to integrate this model into [LIO](https://github.com/MALBECC/lio), our in-house GPU-accelerated DFT code, enabling real-time Exc predictions during self-consistent field (SCF) iterations to 
accelerate DFT workflows without loosing the electronic structure description (something that happens when one uses a typical neural network interatomic potential).

